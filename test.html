<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Mock Login API Demo | Snowfoxlab</title>
    <style>
      /* Reset & base */
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to bottom, #001f3f, #004080);
        color: #f0f0f5;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        overflow-x: hidden;
        position: relative;
      }

      /* Container */
      .container {
        background: rgba(0, 32, 64, 0.85);
        padding: 30px 40px;
        border-radius: 15px;
        box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
        max-width: 480px;
        width: 90%;
        text-align: center;
        position: relative;
        z-index: 10;
      }

      h1 {
        margin-bottom: 20px;
        font-weight: 700;
        text-shadow: 0 0 8px #00aaff88;
      }

      pre {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 8px;
        max-height: 150px;
        overflow-y: auto;
        font-size: 14px;
        color: #d1eaff;
        user-select: text;
        margin-bottom: 25px;
        text-align: left;
        box-shadow: inset 0 0 10px #00aaff33;
      }

      /* Buttons */
      button {
        background: #007acc;
        border: none;
        border-radius: 8px;
        padding: 12px 20px;
        margin: 8px 10px 8px 0;
        font-size: 1rem;
        color: white;
        cursor: pointer;
        box-shadow: 0 5px 15px #007acc99;
        transition: all 0.3s ease;
        user-select: none;
      }
      button:hover {
        background: #00aaff;
        box-shadow: 0 8px 20px #00aaffcc;
        transform: translateY(-2px);
      }
      button:active {
        transform: translateY(1px);
        box-shadow: 0 3px 10px #0088cccc;
      }

      /* Footer */
      footer {
        margin-top: 40px;
        padding: 20px 10px 40px;
        text-align: center;
        font-size: 0.9rem;
        color: #aaccee99;
        position: relative;
        z-index: 10;
      }
      footer a {
        color: #00aaffcc;
        text-decoration: none;
        font-weight: 600;
      }
      footer a:hover {
        text-decoration: underline;
      }

      /* Snow canvas full screen */
      #snow-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: 5;
        user-select: none;
      }

      /* Responsive */
      @media (max-width: 520px) {
        .container {
          padding: 20px 25px;
        }
        button {
          padding: 10px 16px;
          font-size: 0.9rem;
        }
      }
    </style>
  </head>
  <body>
    <canvas id="snow-canvas"></canvas>

    <div class="container" role="main">
      <h1>Mock Login API Demo</h1>

      <div>
        <strong>Current User:</strong>
        <pre id="userDisplay">None</pre>
      </div>

      <div>
        <button id="loginBtn">Login</button>
        <button id="logoutBtn">Logout</button>
        <button id="getTokenBtn">Get Token</button>
        <button id="clearBtn">Clear</button>
      </div>
    </div>

    <footer>
      Developed by <strong>Snowfoxlab</strong> Â· Maintained by
      <a
        href="https://github.com/bikashadhikari07"
        target="_blank"
        rel="noopener noreferrer"
        >Bikash Adhikari</a
      >
      Â·
      <a
        href="https://github.com/snowfoxlab/mock-login-api"
        target="_blank"
        rel="noopener noreferrer"
        >GitHub Repo</a
      >
    </footer>

    <script type="module">
      import { login, getUser, getToken, logout, clear } from "./index.js";

      const userDisplay = document.getElementById("userDisplay");
      const loginBtn = document.getElementById("loginBtn");
      const logoutBtn = document.getElementById("logoutBtn");
      const getTokenBtn = document.getElementById("getTokenBtn");
      const clearBtn = document.getElementById("clearBtn");

      function updateUserDisplay() {
        const user = getUser();
        userDisplay.textContent = user ? JSON.stringify(user, null, 2) : "None";
      }

      loginBtn.onclick = () => {
        const user = login({
          username: "snowfoxlab",
          role: "admin",
          email: "contact@snowfoxlab.com.np",
        });
        console.log("âœ… Logged in:", user);
        updateUserDisplay();
      };

      logoutBtn.onclick = () => {
        logout();
        console.log("ðŸ”’ Logged out");
        updateUserDisplay();
      };

      getTokenBtn.onclick = () => {
        const token = getToken();
        alert(token ? `Token:\n${token}` : "No token found");
        console.log("ðŸ”‘ Token:", token);
      };

      clearBtn.onclick = () => {
        clear();
        console.log("ðŸ§¹ Cleared storage");
        updateUserDisplay();
      };

      // Initialize display on page load
      updateUserDisplay();

      // Snowfall effect
      const canvas = document.getElementById("snow-canvas");
      const ctx = canvas.getContext("2d");

      let width, height;
      let flakes = [];

      function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
      }
      window.addEventListener("resize", resize);
      resize();

      function createFlakes(count) {
        flakes = [];
        for (let i = 0; i < count; i++) {
          flakes.push({
            x: Math.random() * width,
            y: Math.random() * height,
            r: Math.random() * 3 + 1,
            d: Math.random() + 1,
            speed: Math.random() * 1 + 0.5,
          });
        }
      }

      function drawFlakes() {
        ctx.clearRect(0, 0, width, height);
        ctx.fillStyle = "rgba(255, 255, 255, 0.8)";
        ctx.beginPath();
        flakes.forEach((flake) => {
          ctx.moveTo(flake.x, flake.y);
          ctx.arc(flake.x, flake.y, flake.r, 0, Math.PI * 2, true);
        });
        ctx.fill();
        updateFlakes();
      }

      function updateFlakes() {
        flakes.forEach((flake) => {
          flake.y += flake.speed;
          flake.x += Math.sin(flake.d) * 0.5;

          if (flake.y > height) {
            flake.x = Math.random() * width;
            flake.y = -flake.r;
          }
        });
      }

      function animate() {
        drawFlakes();
        requestAnimationFrame(animate);
      }

      createFlakes(100);
      animate();
    </script>
  </body>
</html>
